(function(){'use strict';var D=Math.cos,E=Math.PI,F=Math.sin,G=Math.floor,H=Math.sqrt;function a(a,b,c){var d=Math.min;let e=a.getContext("2d"),f=window.innerWidth,g=window.innerHeight;var h=d(f/b,g/c);a.style.width=f+"px",a.style.height=g+"px",a.width=f,a.height=g;return e.setTransform(h,0,0,h,f/2-b/2*h,g/2-c/2*h),{canvas:a,nativeWidth:b,nativeHeight:c}}function b(a,b,c,d){return H((c-a)**2+(d-b)**2)}function c(c,a){let b=a.x-c.x,d=a.y-c.y;return H(b**2+d**2)}function d(...a){if(4==a.length)return b(...a);if(2==a.length)return c(...a);throw"ERROR: Pass 4 numbers for cordinates or 2 objects with x,y props"}function f(...a){window.LOGGER&&console.log(...a)}function g(a){return a.toUpperCase().charCodeAt(0)-46}function h(a){return a.split("").map(g)}function i(a,b,c,d,e=1,f="text_spritesheet.png"){let g=new Image;g.src=f;let j=a.getContext("2d");j.save(),j.scale(e,e);let k=h(b);for(let h=0;h<k.length;h++){const a=k[h];j.drawImage(g,16*a,0,16,16,c+16*h,d/e,16,16)}j.restore()}function j(a){var b=G(a/6e4),c=(a%6e4/1e3).toFixed(0);return b+":"+(10>c?"0":"")+c}function k(){this.setSettings=function(a){for(var b=0;24>b;b++)this[String.fromCharCode(97+b)]=a[b]||0;.01>this.c&&(this.c=.01);var c=this.b+this.c+this.e;if(.18>c){var d=.18/c;this.b*=d,this.c*=d,this.e*=d}}}function l(a,b,c,d){let e=new Image;e.src=`${d}`;return{conf:a,x:b,y:c,rotation:0,img:e}}function m(a,b,c,d,e){return{...a,dx:b,dy:c,type:d,radius:e,rotation:G(360*Math.random()),innerRotation:0,alive:!0}}function n(a){const b=a.conf.canvas.getContext("2d");b.save(),b.imageSmoothingEnabled=!1;const{x:c,y:d,innerRotation:e,type:f}=a,g=c+.5*32,h=d+.5*32;b.save(),b.translate(g,h),b.rotate(E/180*e),b.translate(-g,-h);"methane"===f?(b.drawImage(a.img,80,0,16,16,c,d,16,16),b.drawImage(a.img,96,0,16,16,c+16,d,16,16),b.drawImage(a.img,112,0,16,16,c,d+16,16,16),b.drawImage(a.img,128,0,16,16,c+16,d+16,16,16)):"dioxide"===f?(b.drawImage(a.img,144,0,16,16,c,d,16,16),b.drawImage(a.img,160,0,16,16,c+16,d,16,16),b.drawImage(a.img,176,0,16,16,c,d+16,16,16),b.drawImage(a.img,192,0,16,16,c+16,d+16,16,16)):void 0;b.restore()}function o(a){if(a.alive){const{conf:b}=a;a.conf.bullets.forEach(b=>{16>=d(a,b)&&(a.alive=!1)}),a.innerRotation-=2,a.x+=D(I(a.rotation))*(1*a.dx),a.y+=F(I(a.rotation))*(1*a.dy),a.x>=b.nativeWidth-32&&(a.x=b.nativeWidth-32,a.dx*=-1),0>=a.x&&(a.x=0,a.dx*=-1),a.y>=b.nativeHeight-32&&(a.y=b.nativeHeight-32,a.dy*=-1),0>=a.y&&(a.y=0,a.dy*=-1)}}function p(a){a.forEach(a=>{o(a)})}function q(a){a.forEach(a=>{n(a)})}function r(a,b){console.log(a);const c=l(Z,b.x+5,b.y+6,"spritesheet.png"),d=s(c,2,2,b.rotation);a.push(d)}function s(a,b,c,d){return{...a,rotation:d,dx:b,dy:c,alive:!0}}function t(a){if(!a.alive)return;const b=a.conf.canvas.getContext("2d");b.save(),b.imageSmoothingEnabled=!1;const{x:c,y:d,rotation:e}=a,f=c+.5*3,g=d+.5*1;b.save(),b.translate(f,g),b.rotate(E/180*e),b.translate(-f,-g),b.drawImage(a.img,24,0,1,16,c,d,8,3),b.restore()}function u(a){a.forEach(a=>{t(a)})}function v(a){return a.alive?void(a.x+=D(I(a.rotation))*(a.dx*N+1),a.y+=F(I(a.rotation))*(a.dy*N+1),a.x>=Z.nativeWidth-8&&(a.x=Z.nativeWidth-8,a.alive=!1),0>=a.x&&(a.x=0,a.alive=!1),a.y>=Z.nativeHeight-8&&(a.y=Z.nativeHeight-8,a.alive=!1),0>=a.y&&(a.y=0,a.alive=!1)):void(a=null)}function w(a){a.forEach(a=>{v(a)})}function x(a,b,c){return{...a,impulse:b,maxImpulse:c}}function y(a){const b=a.conf.canvas.getContext("2d");b.save(),b.imageSmoothingEnabled=!1;const{x:c,y:d}=a;b.save(),b.drawImage(a.img,24,0,1,16,c,d,100,16),b.drawImage(a.img,54,0,1,16,c,d,100*M/N,16),i(a.conf.canvas,"impulse",c+408,d+4,.5),b.restore()}function z(a){const b=a.conf.canvas.getContext("2d");b.save(),b.imageSmoothingEnabled=!1;const{x:c,y:d}=a;b.save(),b.drawImage(a.img,24,0,1,16,c,d,100,16),b.drawImage(a.img,38,0,1,16,c,d,40,16),i(a.conf.canvas,"oxygen",c+220,d+4,.5),b.restore()}function A(a){a.alive&&(a.conf.molecules.forEach(b=>{16>=d(a,b)&&(a.alive=!1)}),a.turnRight?a.rotation=360>a.rotation?a.rotation+=2:a.rotation=0:a.turnLeft&&(a.rotation=0<a.rotation?a.rotation-=2:a.rotation=360),a.x+=D(I(a.rotation))*(a.dx*M),a.y+=F(I(a.rotation))*(a.dy*M),a.x>=Z.nativeWidth-16&&(a.x=Z.nativeWidth-16),0>=a.x&&(a.x=0),a.y>=Z.nativeHeight-16&&(a.y=Z.nativeHeight-16),0>=a.y&&(a.y=0))}function B(a){if(!a.alive)return;const b=a.conf.canvas.getContext("2d");b.save(),b.imageSmoothingEnabled=!1;const{x:c,y:d,rotation:e}=a,f=c+.5*16,g=d+.5*16;b.save(),b.translate(f,g),b.rotate(E/180*e),b.translate(-f,-g),b.drawImage(a.img,0,0,16,16,c,d,16,16),b.restore()}function C(){if(requestAnimationFrame(C),L.clearRect(0,-0,Z.nativeWidth,Z.nativeHeight),O=new Date().getTime(),1e3<=O-R&&(U=T-(O-S),R=O),W){V=navigator.getGamepads();const a=V[0],b=a.buttons[14],c=a.buttons[15],d=a.buttons[12],e=a.buttons[13],f=a.buttons[0];_.turnLeft=!!b.pressed,_.turnRight=!!c.pressed,P=!!d.pressed,Q=!!e.pressed,f.pressed&&r(Z.bullets,_)}A(_),B(_),w(Z.bullets),u(Z.bullets),p(Z.molecules),q(Z.molecules),i(Z.canvas,j(U),Z.nativeWidth/2-48,8,1),z(aa),y(ba),P&&(M+=.02,M>=N&&(M=N)),Q&&(M*=.98,0>=M&&(M=0)),L.save(),L.lineWidth=1,L.strokeStyle="purple",L.strokeRect(0,0,Z.nativeWidth,Z.nativeHeight),L.restore()}const I=a=>a*E/180;var J=new function(){this._params=new k;var a,b,c,d,e,f,g,h,l,m,o,q;this.reset=function(){var a=this._params;d=100/(a.f*a.f+.001),e=100/(a.g*a.g+.001),f=1-.01*(a.h*a.h*a.h),g=1e-6*(-a.i*a.i*a.i),a.a||(o=.5-a.n/2,q=5e-5*-a.o),h=1+a.l*a.l*(0<a.l?-.9:10),l=0,m=1==a.m?0:2e4*((1-a.m)*(1-a.m))+32},this.totalReset=function(){this.reset();var d=this._params;return a=1e5*(d.b*d.b),b=1e5*(d.c*d.c),c=1e5*(d.e*d.e)+12,3*(0|(a+b+c)/3)},this.synthWave=function(k,r){var s=Math.abs,t=this._params,p=1!=t.s||t.v,u=.1*(t.v*t.v),v=1+3e-4*t.w,w=.1*(t.s*t.s*t.s),x=1+1e-4*t.t,y=1!=t.s,z=t.x*t.x,A=t.g,B=t.q||t.r,C=.2*(t.r*t.r*t.r),D=t.q*t.q*(0>t.q?-1020:1020),E=t.p?(0|2e4*((1-t.p)*(1-t.p)))+32:0,G=t.d,H=t.j/2,I=.01*(t.k*t.k),J=t.a,K=a,L=1/a,M=1/b,N=1/c,O=5/(1+20*(t.u*t.u))*(.01+w);.8<O&&(O=.8),O=1-O;for(var P,Q,R,S,T,U,V=!1,W=0,X=0,Y=0,Z=0,$=0,_=0,aa=0,ba=0,ca=0,da=0,ea=Array(1024),fa=Array(32),ga=ea.length;ga--;)ea[ga]=0;for(var ga=fa.length;ga--;)fa[ga]=2*Math.random()-1;for(var ga=0;ga<r;ga++){if(V)return ga;if(E&&++ca>=E&&(ca=0,this.reset()),m&&++l>=m&&(m=0,d*=h),f+=g,d*=f,d>e&&(d=e,0<A&&(V=!0)),Q=d,0<H&&(da+=I,Q*=1+F(da)*H),Q|=0,8>Q&&(Q=8),J||(o+=q,0>o?o=0:.5<o&&(o=.5)),++X>K)switch(X=0,++W){case 1:K=b;break;case 2:K=c;}0===W?Y=X*L:1===W?Y=1+2*(1-X*M)*G:2===W?Y=1-X*N:3===W?(Y=0,V=!0):void 0,B&&(D+=C,R=0|D,0>R?R=-R:1023<R&&(R=1023)),p&&v&&(u*=v,1e-5>u?u=1e-5:.1<u&&(u=.1)),U=0;for(var ha=8;ha--;){if(aa++,aa>=Q&&(aa%=Q,3==J))for(var ia=fa.length;ia--;)fa[ia]=2*Math.random()-1;0===J?T=aa/Q<o?.5:-.5:1===J?T=1-2*(aa/Q):2===J?(S=aa/Q,S=6.28318531*(.5<S?S-1:S),T=1.27323954*S+.405284735*S*S*(0>S?1:-1),T=.225*((0>T?-1:1)*T*T-T)+T):3===J?T=fa[s(0|32*aa/Q)]:void 0,p&&(P=_,w*=x,0>w?w=0:.1<w&&(w=.1),y?($+=(T-_)*w,$*=O):(_=T,$=0),_+=$,Z+=_-P,Z*=1-u,T=Z),B&&(ea[ba%1024]=T,T+=ea[(ba-R+1024)%1024],ba++),U+=T}U*=.125*Y*z,k[ga]=1<=U?32767:-1>=U?-32768:0|32767*U}return r}};const K=document.getElementsByTagName("canvas")[0],L=K.getContext("2d");let M=0;const N=2;let O,P=!1,Q=!1,R=new Date().getTime();const S=R,T=6e4;let U=6e4;let V,W=!1;var X=function(b){J._params.setSettings(b);var c=J.totalReset(),d=new Uint8Array(4*(0|(c+1)/2)+44),e=2*J.synthWave(new Uint16Array(d.buffer,44),c),f=new Uint32Array(d.buffer,0,44);f[0]=1179011410,f[1]=e+36,f[2]=1163280727,f[3]=544501094,f[4]=16,f[5]=65537,f[6]=44100,f[7]=88200,f[8]=1048578,f[9]=1635017060,f[10]=e,e+=44;for(var g=0,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",j="data:audio/wav;base64,";g<e;g+=3){var k=d[g]<<16|d[g+1]<<8|d[g+2];j+=h[k>>18]+h[63&k>>12]+h[63&k>>6]+h[63&k]}return j}([0,,.1812,,.1349,.4524,,.2365,,,,,,.0819,,,,,1,,,,,.5]),Y=new Audio;Y.src=X,Y.play();const Z={...a(K,640,360),molecules:[],bullets:[],sfx:{fire:"0,,0.1763,0.1127,0.3663,0.6359,0.2,-0.2168,,,,,,0.4917,-0.5835,,,,1,,,0.103,,0.5"}};a(K,Z.nativeWidth,Z.nativeHeight),window.addEventListener("resize",()=>{a(K,Z.nativeWidth,Z.nativeHeight)}),window.addEventListener("gamepadconnected",a=>{console.log("Gamepad connected at index %d: %s. %d buttons, %d axes.",a.gamepad.index,a.gamepad.id,a.gamepad.buttons.length,a.gamepad.axes.length),W=!0});const $=l(Z,Z.nativeWidth/2,Z.nativeHeight/2,"spritesheet.png"),_=function(a,b,c,d=!1,e=!1){return{...a,dx:b,dy:c,turnLeft:d,turnRight:e,alive:!0}}($,2,2),aa=function(a,b,c){return{...a,current:b,goal:c}}(l(Z,16,8,"spritesheet.png"),5,2),ba=x(l(Z,525,8,"spritesheet.png"),M,2);(function(a){const b=37,c=38,d=39,g=40;let h=new Audio;h.src=$.conf.sfx.fire,window.addEventListener("keydown",f=>{const e=f.keyCode;switch(e){case d:a.turnRight=!0;break;case b:a.turnLeft=!0;break;case 32:r(Z.bullets,a),arcadeAudio.play("laser");break;default:}e==c&&(P=!0),e==g&&(Q=!0)}),window.addEventListener("keyup",f=>{const e=f.keyCode;switch(e){case d:a.turnRight=!1;break;case b:a.turnLeft=!1;break;default:}e==c&&(P=!1),e==g&&(Q=!1)}),window.addEventListener("gamepadconnected",a=>{const b=navigator.getGamepads()[a.gamepad.index];f("Gamepad connected at index %d: %s. %d buttons, %d axes.",b.index,b.id,b.buttons.length,b.axes.length)})})(_),function(a,b){for(let c=0;c<b;c++){const b=l(a,Math.random()*a.nativeWidth,Math.random()*a.nativeHeight,"spritesheet.png");a.molecules.push(m(b,1,1,.5<=Math.random()?"methane":"dioxide",16))}}(Z,5),C()})();
//# sourceMappingURL=bundle.js.map
